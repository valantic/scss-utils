@use 'sass:map';
@use 'sass:meta';
@use 'sass:list';
@use '../variables';
@use '../functions';
@use './media';

////
/// Generates utility classes for spacing values across breakpoints.
///
/// - Loops through `$spacings` to create base utility classes.
/// - Adds responsive classes for each spacing value across valid breakpoints.
/// - Automatically excludes invalid breakpoints.
///
/// @param {string} $class The base class name (e.g., `margin`, `padding`).
/// @param {string} $property The CSS property to assign (e.g., `margin`, `padding`).
/// @param {list} [$spacings=variables.$va-spacings] The list of spacing values to generate classes for.
/// @param {map} [$breakpoints=variables.$va-breakpoints] The map of breakpoints used for responsive classes.
///
@mixin spacings($class, $property, $spacings: variables.$va-spacings, $breakpoints: variables.$va-breakpoints) {
  // Validate inputs
  @if meta.type-of($spacings) != 'list' {
    @error "@valantic-scss-utils -- 'spacings': $spacings must be a list. Received: #{meta.type-of($spacings)}.";
  }

  @if meta.type-of($breakpoints) != 'map' {
    @error "@valantic-scss-utils -- 'spacings': $breakpoints must be a map. Received: #{meta.type-of($breakpoints)}.";
  }

  // Generate base utility classes
  @each $spacing in $spacings {
    @if $spacing != 0 {
      .#{$class}-#{functions.strip-unit($spacing)} {
        #{$property}: #{$spacing};
      }
    }
  }

  // Generate responsive utility classes
  @each $breakpoint, $value in $breakpoints {
    @if $value != null and $breakpoint != 'xxs' {
      @include media.media($breakpoint) {
        @each $spacing in $spacings {
          @if $spacing != 0 {
            .#{$class}-#{$breakpoint}-#{functions.strip-unit($spacing)} {
              #{$property}: #{$spacing};
            }
          }
        }
      }
    }
  }
}
